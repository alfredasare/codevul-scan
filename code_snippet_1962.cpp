Here's the fixed version of the code, taking into account the recommendation to check for NULL after calling `gs_alloc_struct`: