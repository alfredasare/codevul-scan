Here's the fixed version of the code, preventing the integer overflow vulnerability: