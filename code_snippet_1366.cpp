Sure, here's the fixed version of the code that addresses the issue of Improper Input Validation (CWE-20) and the specific vulnerability CVE-2018-1000037: