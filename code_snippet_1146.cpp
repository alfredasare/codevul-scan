static inline int sock\_sendto(php\_netstream\_data\_t \*sock, const char \*buf, size\_t buflen, int flags, struct sockaddr \*addr, socklen\_t addrlen) { int ret; if (buflen > INT\_MAX) { return -1; } if (addr) { if (addrlen > sizeof(sock->address)) { return -1; } ret = sendto(sock->socket, buf, (int)buflen, flags, addr, (int)addrlen); return (ret == SOCK\_CONN\_ERR) ? -1 : ret; } #ifdef PHP\_WIN32 if (buflen > INT\_MAX) { return -1; } ret = send(sock->socket, buf, (int)buflen, flags); return (ret == SOCK\_CONN\_ERR) ? -1 : ret; #else ret = send(sock->socket, buf, (int)buflen, flags); return (ret == SOCK\_CONN\_ERR) ? -1 : ret; #endif }