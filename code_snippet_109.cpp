Sure, here's the fixed version of the code that addresses the information disclosure vulnerability (CWE-732) described in CVE-2018-1